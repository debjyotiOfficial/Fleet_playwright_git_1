const a21_0x4e8a3c=a21_0x3d11;(function(_0x9387d7,_0x2e1892){const _0xc47129=a21_0x3d11,_0x1fff1d=_0x9387d7();while(!![]){try{const _0x1c5da9=parseInt(_0xc47129(0x1c7))/0x1+-parseInt(_0xc47129(0x1e5))/0x2+parseInt(_0xc47129(0x1c5))/0x3*(-parseInt(_0xc47129(0x1ee))/0x4)+-parseInt(_0xc47129(0x1e8))/0x5*(-parseInt(_0xc47129(0x1bb))/0x6)+-parseInt(_0xc47129(0x1f5))/0x7*(-parseInt(_0xc47129(0x1ed))/0x8)+parseInt(_0xc47129(0x1a0))/0x9+-parseInt(_0xc47129(0x1ab))/0xa;if(_0x1c5da9===_0x2e1892)break;else _0x1fff1d['push'](_0x1fff1d['shift']());}catch(_0x4ca9b8){_0x1fff1d['push'](_0x1fff1d['shift']());}}}(a21_0x5724,0xe1358));function a21_0x3d11(_0x2498f7,_0x1d774f){const _0x57244b=a21_0x5724();return a21_0x3d11=function(_0x3d1126,_0x5c7cb5){_0x3d1126=_0x3d1126-0x19d;let _0x4d01e2=_0x57244b[_0x3d1126];return _0x4d01e2;},a21_0x3d11(_0x2498f7,_0x1d774f);}const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require('reconnecting-websocket'),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require('../../config/constants'),{logger}=require(a21_0x4e8a3c(0x1f6)),{getCredentialsPath,getGridDetails}=require(a21_0x4e8a3c(0x1b0)),{scaleDownHubDeployment}=require(a21_0x4e8a3c(0x1a6)),{sendInstrumentationEvent}=require(a21_0x4e8a3c(0x1f1)),webSocketUtils=require(a21_0x4e8a3c(0x1b3)),{createK8sClient}=require(a21_0x4e8a3c(0x1f3)),{getCloudProviderObject}=require(a21_0x4e8a3c(0x1c6));function a21_0x5724(){const _0x4922a9=['skip-tls-cert-verify','7EEeRMM','../../config/logger','parse','error','BQSas','addListeners','usage','16320438bGWzJP','epilogue','Adding\x20Websocket\x20listeners','default','uObAj','clusterName','../../utils/gridComponents','bstackAccesskey','yukRv','TjGvv','VtqAQ','12864640FtxdFK','pvOZD','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','exit','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','../../utils/utilityMethods','yzeDT','bZnzm','../../utils/webSocketUtils','<UsernamePlaceholder>','dCSbN','Skip\x20insecure\x20cert\x20verification.','Stop\x20a\x20running\x20Automation\x20grid.','stop','BIKcU','info','288186RzEgFD','gridId','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','message','stop-grid-called','skipTlsCertVerify','Browserstack','ggKks','pvllj','command','51PHjirl','../../cloudproviders/utils','1058935AQrhcV','DUpbi','boolean','UsPyX','help','cloudProvider','Peevn','Zqneb','INFO','IwOME','ERROR','clusterRegion','server-error','password','options','zoFfS','<PasswordPlaceholder>','name','PuuTT','Yacuf','existsSync','connectionTimeout','IQAUk','dLaPW','handler','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','grid-id','statusCode','Stopping\x20grid\x20','grid','2289420gkkolZ','description','stack','25xxKazF','username','WkjrP','Grid\x20stoppped.','stringify','12815248QtBCTB','320176QzuRej','replace','bstackUsername','../../utils/instrumentationUtils','user','../../utils/createk8sClient'];a21_0x5724=function(){return _0x4922a9;};return a21_0x5724();}exports[a21_0x4e8a3c(0x1c4)]=a21_0x4e8a3c(0x1e4),exports['desc']=a21_0x4e8a3c(0x1b7),exports['builder']=function(_0x1ee0b8){const _0x186abf=a21_0x4e8a3c,_0x4e7437={};_0x4e7437[_0x186abf(0x1c2)]='Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.',_0x4e7437[_0x186abf(0x1ac)]='string',_0x4e7437[_0x186abf(0x1b5)]=_0x186abf(0x1b6),_0x4e7437['pvllj']=_0x186abf(0x1c9),_0x4e7437[_0x186abf(0x1ca)]=_0x186abf(0x1cb);const _0x17d556=_0x4e7437,_0x154d60={};_0x154d60[_0x186abf(0x1e6)]=_0x17d556[_0x186abf(0x1c2)],_0x154d60['type']=_0x17d556['pvOZD'];const _0x21a91e={};_0x21a91e['description']=_0x17d556[_0x186abf(0x1b5)],_0x21a91e['type']=_0x17d556[_0x186abf(0x1c3)],_0x21a91e[_0x186abf(0x1a3)]=![];const _0x2d2ffe={};return _0x2d2ffe[_0x186abf(0x1e1)]=_0x154d60,_0x2d2ffe[_0x186abf(0x1f4)]=_0x21a91e,_0x1ee0b8[_0x186abf(0x19f)](HELP_HEADER_MESSAGE[_0x186abf(0x1b8)])[_0x186abf(0x1a1)](HELP_FOOTER_MESSAGE)[_0x186abf(0x1d5)](_0x2d2ffe)['help'](_0x17d556[_0x186abf(0x1ca)])['argv'];},exports[a21_0x4e8a3c(0x1df)]=async function(_0x580146){const _0x15ccb2=a21_0x4e8a3c,_0x8b2024={'eocXo':'Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','DUpbi':function(_0xd0e05f){return _0xd0e05f();},'bZnzm':_0x15ccb2(0x1e0),'yzeDT':function(_0xb1d941,_0x5944e0,_0x5b609e,_0x124349,_0x41faac,_0x10605d,_0xbb5fc8){return _0xb1d941(_0x5944e0,_0x5b609e,_0x124349,_0x41faac,_0x10605d,_0xbb5fc8);},'Peevn':_0x15ccb2(0x1bf),'PuuTT':'init-not-called','Zqneb':_0x15ccb2(0x1b4),'TjGvv':_0x15ccb2(0x1d7),'zoFfS':_0x15ccb2(0x1a2),'VtqAQ':function(_0x1542c9,_0x1d60f9,_0x4b4d1f,_0x1fde9d){return _0x1542c9(_0x1d60f9,_0x4b4d1f,_0x1fde9d);},'IQAUk':function(_0x208262,_0x4a8297,_0x336b91){return _0x208262(_0x4a8297,_0x336b91);},'WkjrP':_0x15ccb2(0x1eb),'Yacuf':function(_0x1f6a6a,_0x1a56c1){return _0x1f6a6a===_0x1a56c1;},'IwOME':_0x15ccb2(0x1ad),'dLaPW':function(_0x37f318,_0x8d04d8,_0xdac47b,_0x4b80ba,_0x59b89d,_0x2a7fc2,_0x374e20){return _0x37f318(_0x8d04d8,_0xdac47b,_0x4b80ba,_0x59b89d,_0x2a7fc2,_0x374e20);},'UbVDF':'unauthorised','BIKcU':function(_0x1b07ea,_0x211608){return _0x1b07ea===_0x211608;},'BQSas':function(_0x5c15ca,_0x4131fb,_0x3e1275,_0x2d5b8c,_0x52a1ee,_0x58aa2b,_0x2e6cca){return _0x5c15ca(_0x4131fb,_0x3e1275,_0x2d5b8c,_0x52a1ee,_0x58aa2b,_0x2e6cca);},'uObAj':'invalid-grid-id','yukRv':function(_0xbedf2a,_0x27c72b,_0x3ce5d7,_0x1d2de5,_0x3f71d3,_0x2bc88d,_0x579f25){return _0xbedf2a(_0x27c72b,_0x3ce5d7,_0x1d2de5,_0x3f71d3,_0x2bc88d,_0x579f25);},'yTwIT':_0x15ccb2(0x1d3)};let _0x365df5;try{!_0x580146[_0x15ccb2(0x1bc)]&&(logger[_0x15ccb2(0x1f8)](_0x8b2024['eocXo']),process[_0x15ccb2(0x1ae)](0x1));!fs[_0x15ccb2(0x1db)](_0x8b2024[_0x15ccb2(0x1c8)](getCredentialsPath))&&(logger['error'](_0x8b2024[_0x15ccb2(0x1b2)]),await _0x8b2024[_0x15ccb2(0x1b1)](sendInstrumentationEvent,_0x580146,_0x8b2024[_0x15ccb2(0x1cd)],messageTypes[_0x15ccb2(0x1d1)],_0x8b2024[_0x15ccb2(0x1d9)],null,_0x580146),process[_0x15ccb2(0x1ae)](0x1));logger['info'](_0x15ccb2(0x1e3)+_0x580146[_0x15ccb2(0x1bc)]),await _0x8b2024[_0x15ccb2(0x1b1)](sendInstrumentationEvent,_0x580146,_0x8b2024[_0x15ccb2(0x1cd)],messageTypes[_0x15ccb2(0x1cf)],null,null,_0x580146);const _0x195b99=JSON[_0x15ccb2(0x1f7)](fs['readFileSync'](_0x8b2024[_0x15ccb2(0x1c8)](getCredentialsPath)));global_registry[_0x15ccb2(0x1f0)]=_0x195b99[_0x15ccb2(0x1c1)]['username'],global_registry[_0x15ccb2(0x1a7)]=_0x195b99['Browserstack'][_0x15ccb2(0x1d4)];const _0x2a7998=WS_ENDPOINT[_0x15ccb2(0x1ef)](_0x8b2024[_0x15ccb2(0x1ce)],_0x195b99[_0x15ccb2(0x1c1)][_0x15ccb2(0x1e9)])[_0x15ccb2(0x1ef)](_0x8b2024[_0x15ccb2(0x1a9)],_0x195b99['Browserstack']['password']),_0x5b95be={};_0x5b95be['WebSocket']=ws,_0x5b95be[_0x15ccb2(0x1dc)]=0x36ee80,_0x365df5=new ReconnectingWebSocket(_0x2a7998,[],_0x5b95be),logger['debug'](_0x8b2024[_0x15ccb2(0x1d6)]),webSocketUtils[_0x15ccb2(0x19e)](_0x365df5,_0x580146[_0x15ccb2(0x1f2)],_0x580146[_0x15ccb2(0x1d4)]);const [_0x3be7b6,_0x432c4e]=await _0x8b2024[_0x15ccb2(0x1aa)](getGridDetails,_0x195b99[_0x15ccb2(0x1c1)]['username'],_0x195b99[_0x15ccb2(0x1c1)][_0x15ccb2(0x1d4)],_0x580146['gridId']);if(_0x432c4e){const _0x2e3f8a=_0x432c4e[_0x15ccb2(0x1ba)];global_registry[_0x15ccb2(0x1cc)]=_0x2e3f8a[_0x15ccb2(0x1cc)],global_registry[_0x15ccb2(0x1d2)]=_0x2e3f8a['region'],global_registry[_0x15ccb2(0x1a5)]=_0x2e3f8a[_0x15ccb2(0x1a5)];const _0x3f0741=await _0x8b2024[_0x15ccb2(0x1b1)](getCloudProviderObject,_0x2e3f8a[_0x15ccb2(0x1cc)],_0x2e3f8a[_0x15ccb2(0x1a5)],_0x2e3f8a[_0x15ccb2(0x1d8)],_0x365df5,webSocketUtils,_0x580146),[_0x5ad8e3,_0x3dd579,_0x41e80e,_0x140021,_0x5bc26c,_0x33279f]=await _0x8b2024[_0x15ccb2(0x1dd)](createK8sClient,_0x3f0741,_0x580146[_0x15ccb2(0x1c0)]);await _0x8b2024['IQAUk'](scaleDownHubDeployment,_0x3dd579,_0x2e3f8a[_0x15ccb2(0x1d8)]),logger[_0x15ccb2(0x1ba)](_0x8b2024[_0x15ccb2(0x1ea)]),process[_0x15ccb2(0x1ae)](0x0);}_0x8b2024[_0x15ccb2(0x1da)](_0x3be7b6['statusCode'],0x191)&&(logger[_0x15ccb2(0x1f8)](_0x8b2024[_0x15ccb2(0x1d0)]),await _0x8b2024[_0x15ccb2(0x1de)](sendInstrumentationEvent,_0x580146,_0x8b2024[_0x15ccb2(0x1cd)],messageTypes[_0x15ccb2(0x1d1)],_0x8b2024['UbVDF'],null,_0x580146),process[_0x15ccb2(0x1ae)](0x1)),_0x8b2024[_0x15ccb2(0x1b9)](_0x3be7b6[_0x15ccb2(0x1e2)],0x190)&&(logger['error'](JSON['parse'](_0x3be7b6['body'])[_0x15ccb2(0x1be)]),await _0x8b2024[_0x15ccb2(0x19d)](sendInstrumentationEvent,_0x580146,_0x8b2024[_0x15ccb2(0x1cd)],messageTypes[_0x15ccb2(0x1d1)],_0x8b2024[_0x15ccb2(0x1a4)],null,_0x580146),process[_0x15ccb2(0x1ae)](0x1)),logger[_0x15ccb2(0x1f8)](_0x15ccb2(0x1af)+JSON[_0x15ccb2(0x1ec)](_0x3be7b6)),await _0x8b2024[_0x15ccb2(0x1a8)](sendInstrumentationEvent,_0x580146,_0x8b2024['Peevn'],messageTypes[_0x15ccb2(0x1d1)],_0x8b2024['yTwIT'],_0x3be7b6,_0x580146),process['exit'](0x1);}catch(_0x5417e3){const _0x4e5b50=_0x15ccb2(0x1bd)+_0x5417e3+'\x20\x0a'+JSON[_0x15ccb2(0x1ec)](_0x5417e3[_0x15ccb2(0x1e7)])+'\x20';logger['error'](_0x4e5b50),process[_0x15ccb2(0x1ae)](0x1);}};