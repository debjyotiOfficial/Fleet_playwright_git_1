#!/usr/bin/env node
'use strict';const a5_0xbd6a01=a5_0x50e3;function a5_0x4fe8(){const _0x2337cd=['XXiBg','../utils/constants','BROWSERSTACK_TEST_ACCESSIBILITY_CONFIGURATION_YML','handleApp','setupTCGAuth','cwd','419508XpNCGk','PLAYWRIGHT','110dEMwUu','17844Ogutqa','removeDir','getTCGConfigFilePaths','isRunning','config','setFrameworkDetail','getPackageVersion','getPlatformName','iHCcr','LTIFU','binSessionId','200039FyHRAV','stop','push','../v2/browserstackCLI','initialize','OMhSK','env','stepsAmbiguous','stepsPending','isUndefined','yellow','nnhSu','../../helpers/utilities','testObservability','jSsLW','../v2/cliUtils','../../helpers/helper','dJCbT','start','qVHdG','537831bsMKpQ','length','1606647MFhyiw','getInstance','stepsFailed','green','exports','IUmXL','../../helpers/BrowserStackSetup','finalExecution','platforms','\x20scenarios','log','lYVhe','CUCUMBER','accessibilityOptions','xIpRC','JWtDE','forEach','qFXPl','555558ntjthX','logLevel','OuESc','red','WEWio','SDK_CLEANUP','bgWhite','getUserWorkerCount','\x20for\x20cucumber-js\x20flow','useW3C','error\x20removing\x20tcg\x20config\x20file','3817536zszFmk','gBYxN','isBrowserstackInfra','\x20passed','stepsPassed','JvqGm','getErrorMessageFromResults','../v2/TestInfo','qMUCf','\x20failed','getHubUrl','FRAMEWORKS','tmp','YXCze','__isPlaywrightInstalled','../../helpers/testhub/testhubHandler','5hHOdnI','\x20undefined','nZbxJ','format','prepareCapabilities','scenariosFailed','setBrowserstackConfig','602rAYvzP','../test-runner','mergeOutputFiles','3|4|1|0|2','../../helpers/logger','stepsUndefined','printBuildLink','true','testContextOptions','util','WoOPN','cyan','unlinkSync','zcnMI','wFrTm','path','RtAzy','****\x20RESULTS\x20****','../../helpers/performance/performance-tester','processSuccess','bold','ynbAf','proxySettings','setUserConfigPath','turboScaleUrl','BROWSERSTACK_TEST_OBSERVABILITY_YML','join','winstonLogger','@playwright/test','\x20ambiguous','debug','SDK_SETUP','Exception\x20in\x20stop\x20build\x20request\x20to\x20testhub\x20:\x20','fzfXj','EqhcV','createDir','split','then','\x20steps','splice','end'];a5_0x4fe8=function(){return _0x2337cd;};return a5_0x4fe8();}(function(_0x3f8efa,_0x246820){const _0x4fc5f7=a5_0x50e3,_0x4fb3fe=_0x3f8efa();while(!![]){try{const _0x41cb9d=-parseInt(_0x4fc5f7(0x176))/0x1+-parseInt(_0x4fc5f7(0x117))/0x2+-parseInt(_0x4fc5f7(0x18c))/0x3+-parseInt(_0x4fc5f7(0x168))/0x4*(parseInt(_0x4fc5f7(0x132))/0x5)+parseInt(_0x4fc5f7(0x16b))/0x6*(parseInt(_0x4fc5f7(0x139))/0x7)+parseInt(_0x4fc5f7(0x122))/0x8+-parseInt(_0x4fc5f7(0x18a))/0x9*(-parseInt(_0x4fc5f7(0x16a))/0xa);if(_0x41cb9d===_0x246820)break;else _0x4fb3fe['push'](_0x4fb3fe['shift']());}catch(_0x503de6){_0x4fb3fe['push'](_0x4fb3fe['shift']());}}}(a5_0x4fe8,0x426bd));const fs=require('fs'),path=require(a5_0xbd6a01(0x148)),util=require(a5_0xbd6a01(0x142)),logger=require(a5_0xbd6a01(0x13d))[a5_0xbd6a01(0x154)],{default:BrowserStackSetup}=require(a5_0xbd6a01(0x192)),helper=require(a5_0xbd6a01(0x186)),utilities=require(a5_0xbd6a01(0x182)),constants=require(a5_0xbd6a01(0x163)),{parallelCucumberRun}=require(a5_0xbd6a01(0x13a)),TestHubHandler=require(a5_0xbd6a01(0x131)),testOpsHelper=require('../../helpers/test-observability/utils'),chalk=require('chalk'),PerformanceTester=require(a5_0xbd6a01(0x14b)),PerformanceEvents=require('../../helpers/performance/constants')['EVENTS'],BrowserstackCLI=require(a5_0xbd6a01(0x179)),CLIUtils=require(a5_0xbd6a01(0x185)),TestInfo=require(a5_0xbd6a01(0x129));function printCucumberStats(_0x270ecc){const _0x2ce956=a5_0xbd6a01,_0x1c6ec1={};_0x1c6ec1[_0x2ce956(0x184)]=function(_0x40079f,_0x7096f5){return _0x40079f>_0x7096f5;},_0x1c6ec1[_0x2ce956(0x15b)]=function(_0x30f4ba,_0x5bf72c){return _0x30f4ba-_0x5bf72c;},_0x1c6ec1[_0x2ce956(0x114)]=function(_0x13d6d5,_0xc03cef){return _0x13d6d5-_0xc03cef;},_0x1c6ec1[_0x2ce956(0x173)]=function(_0x59a53a,_0x1e3b8e){return _0x59a53a>_0x1e3b8e;},_0x1c6ec1['LTIFU']=function(_0x3c05e0,_0x8cf30){return _0x3c05e0>_0x8cf30;},_0x1c6ec1[_0x2ce956(0x189)]=function(_0x5164cb,_0x5e1c16){return _0x5164cb>_0x5e1c16;},_0x1c6ec1['qFXPl']=function(_0x3e68ee,_0x4bc6c9){return _0x3e68ee>_0x4bc6c9;},_0x1c6ec1[_0x2ce956(0x191)]=function(_0x119d5c,_0x557f38){return _0x119d5c>_0x557f38;},_0x1c6ec1['xIpRC']=function(_0x22db76,_0x209462){return _0x22db76>_0x209462;},_0x1c6ec1[_0x2ce956(0x134)]=function(_0x2aa70b,_0x4f6279){return _0x2aa70b+_0x4f6279;},_0x1c6ec1[_0x2ce956(0x14e)]=function(_0x9a1d42,_0x4b6a54){return _0x9a1d42+_0x4b6a54;},_0x1c6ec1[_0x2ce956(0x143)]=function(_0x4a2e24,_0xd10211){return _0x4a2e24+_0xd10211;},_0x1c6ec1[_0x2ce956(0x147)]=function(_0x3ff3c2,_0x2224db){return _0x3ff3c2===_0x2224db;},_0x1c6ec1[_0x2ce956(0x15a)]=function(_0x21e218,_0x4a0bd4){return _0x21e218===_0x4a0bd4;},_0x1c6ec1[_0x2ce956(0x12f)]=_0x2ce956(0x14a);const _0x36b5c2=_0x1c6ec1;let _0x1fd66c=0x0;if(_0x36b5c2['fzfXj'](_0x270ecc[_0x2ce956(0x18b)],0x0))return _0x1fd66c;return console[_0x2ce956(0x10f)](chalk[_0x2ce956(0x14d)][_0x2ce956(0x11d)](_0x36b5c2[_0x2ce956(0x12f)])),_0x270ecc[_0x2ce956(0x115)](_0xb55919=>{const _0x1ba807=_0x2ce956,_0x3d3192=_0xb55919[0x0],_0x574956=_0xb55919[0x1];helper['isBrowserstackInfra']()&&console[_0x1ba807(0x10f)]('\x0a'+chalk['bold']['yellow'](''+helper[_0x1ba807(0x172)](_0x3d3192)));const _0x3302bd=_0x574956['scenarios'],_0x376ee0=_0x574956['steps'],_0x1e3339=_0x574956[_0x1ba807(0x137)],_0xe6bbb0=_0x574956[_0x1ba807(0x18e)],_0x3dc456=_0x574956[_0x1ba807(0x126)],_0x57a557=_0x574956['stepsSkipped'],_0x2753c0=_0x574956[_0x1ba807(0x17e)],_0x4ea5c4=_0x574956[_0x1ba807(0x13e)],_0x1029f7=_0x574956['stepsUnknown'],_0x1b0693=_0x574956[_0x1ba807(0x17d)],_0x249f2b=_0x574956[_0x1ba807(0x14c)];let _0x3b2bb3=_0x3302bd+_0x1ba807(0x10e);const _0x1ce070=_0x36b5c2['jSsLW'](_0x36b5c2[_0x1ba807(0x15b)](_0x3302bd,_0x1e3339),0x0)?_0x36b5c2[_0x1ba807(0x114)](_0x3302bd,_0x1e3339):0x0;if(_0x36b5c2['jSsLW'](_0x1e3339,0x0)&&_0x36b5c2['jSsLW'](_0x1ce070,0x0))_0x3b2bb3+='\x20('+chalk[_0x1ba807(0x14d)][_0x1ba807(0x11a)](_0x1e3339+_0x1ba807(0x12b))+',\x20'+chalk[_0x1ba807(0x14d)][_0x1ba807(0x18f)](_0x1ce070+_0x1ba807(0x125))+')';else(_0x36b5c2[_0x1ba807(0x184)](_0x1e3339,0x0)||_0x36b5c2['iHCcr'](_0x1ce070,0x0))&&(_0x3b2bb3+=_0x36b5c2['LTIFU'](_0x1e3339,0x0)?'\x20('+chalk[_0x1ba807(0x14d)]['red'](_0x1e3339+'\x20failed')+')':'\x20('+chalk[_0x1ba807(0x14d)][_0x1ba807(0x18f)](_0x1ce070+_0x1ba807(0x125))+')');const _0x1a3774=_0x376ee0+_0x1ba807(0x15f),_0x2cb8b8=[];_0x36b5c2['qVHdG'](_0x1b0693,0x0)&&_0x2cb8b8[_0x1ba807(0x178)](''+chalk['bold']['red'](_0x1b0693+_0x1ba807(0x156)));_0x36b5c2[_0x1ba807(0x174)](_0xe6bbb0,0x0)&&_0x2cb8b8[_0x1ba807(0x178)](''+chalk[_0x1ba807(0x14d)][_0x1ba807(0x11a)](_0xe6bbb0+_0x1ba807(0x12b)));_0x36b5c2[_0x1ba807(0x189)](_0x3dc456,0x0)&&_0x2cb8b8['push'](''+chalk[_0x1ba807(0x14d)][_0x1ba807(0x18f)](_0x3dc456+_0x1ba807(0x125)));_0x36b5c2[_0x1ba807(0x116)](_0x2753c0,0x0)&&_0x2cb8b8['push'](''+chalk[_0x1ba807(0x14d)][_0x1ba807(0x180)](_0x2753c0+'\x20pending'));_0x36b5c2[_0x1ba807(0x191)](_0x57a557,0x0)&&_0x2cb8b8[_0x1ba807(0x178)](''+chalk[_0x1ba807(0x14d)][_0x1ba807(0x144)](_0x57a557+'\x20skipped'));_0x36b5c2[_0x1ba807(0x189)](_0x4ea5c4,0x0)&&_0x2cb8b8['push'](''+chalk[_0x1ba807(0x14d)][_0x1ba807(0x180)](_0x4ea5c4+_0x1ba807(0x133)));_0x36b5c2[_0x1ba807(0x113)](_0x1029f7,0x0)&&_0x2cb8b8['push'](''+chalk[_0x1ba807(0x14d)][_0x1ba807(0x180)](_0x1029f7+'\x20skipped'));const _0xdab9b=_0x36b5c2[_0x1ba807(0x134)](_0x36b5c2[_0x1ba807(0x134)](_0x36b5c2[_0x1ba807(0x134)](_0x1a3774,'('),_0x2cb8b8['join'](',\x20')),')');console[_0x1ba807(0x10f)](_0x36b5c2[_0x1ba807(0x14e)](_0x36b5c2[_0x1ba807(0x134)](_0x36b5c2[_0x1ba807(0x143)](_0x36b5c2[_0x1ba807(0x134)]('\x0a',_0x3b2bb3),'\x0a'),_0xdab9b),'\x0a')),_0x36b5c2[_0x1ba807(0x147)](_0x249f2b,![])&&(_0x1fd66c=0x1);}),_0x1fd66c;}function a5_0x50e3(_0x1c0fbb,_0x59d5ef){const _0x4fe8be=a5_0x4fe8();return a5_0x50e3=function(_0x50e392,_0x1d942e){_0x50e392=_0x50e392-0x10e;let _0x2a6ac6=_0x4fe8be[_0x50e392];return _0x2a6ac6;},a5_0x50e3(_0x1c0fbb,_0x59d5ef);}async function run(_0x537dba,_0x1d252a,_0xbcd0db){const _0x461135=a5_0xbd6a01,_0x176df5={'OuESc':function(_0x87da46,_0x1ba3f7){return _0x87da46(_0x1ba3f7);},'nnhSu':function(_0x52a9c0,_0x8ca22d){return _0x52a9c0>_0x8ca22d;},'WEWio':'Generating\x20consolidated\x20report...','RtAzy':'Removing\x20tmp\x20directory\x20created\x20for\x20reports','gBYxN':'cucumber','XXiBg':_0x461135(0x121),'JvqGm':_0x461135(0x155),'dJCbT':_0x461135(0x13c),'zcnMI':_0x461135(0x12e),'OMhSK':function(_0x1dd882,_0x55e95a){return _0x1dd882>_0x55e95a;},'lYVhe':function(_0x2d3477,_0x100510){return _0x2d3477-_0x100510;},'OyLVd':function(_0x13e8cb,_0x43ccee){return _0x13e8cb>=_0x43ccee;},'qMUCf':function(_0x5dc09a,_0x297d20){return _0x5dc09a!=_0x297d20;},'SSXxO':_0x461135(0x140),'sYHlf':function(_0xbf20f6,_0xd37b72,_0x448308,_0x1c3fd3,_0x51c2f8,_0x35458f){return _0xbf20f6(_0xd37b72,_0x448308,_0x1c3fd3,_0x51c2f8,_0x35458f);}},_0x5acc95=helper[_0x461135(0x171)](_0x176df5[_0x461135(0x127)]);let _0x51d85d=constants[_0x461135(0x12d)][_0x461135(0x111)];global[_0x461135(0x130)]=!!_0x5acc95,await _0xbcd0db[_0x461135(0x17a)](_0x537dba);if(_0x5acc95){const _0x1b0baf=_0x176df5[_0x461135(0x187)][_0x461135(0x15d)]('|');let _0x27ceb2=0x0;while(!![]){switch(_0x1b0baf[_0x27ceb2++]){case'0':BrowserstackCLI[_0x461135(0x18d)]()[_0x461135(0x138)](_0xbcd0db['config'],_0xbcd0db['cliConfig']);continue;case'1':CLIUtils[_0x461135(0x170)](constants[_0x461135(0x12d)][_0x461135(0x111)],_0x51d85d);continue;case'2':await BrowserstackCLI['getInstance']()['bootstrap']();continue;case'3':_0x51d85d=constants[_0x461135(0x12d)][_0x461135(0x169)];continue;case'4':logger[_0x461135(0x157)]('Detected\x20Playwright\x20version\x20'+_0x5acc95+_0x461135(0x11f));continue;}break;}}BrowserstackCLI[_0x461135(0x18d)]()['binSessionId']&&(process[_0x461135(0x17c)]['BROWSERSTACK_CLI_BIN_SESSION_ID']=BrowserstackCLI[_0x461135(0x18d)]()[_0x461135(0x175)]);helper[_0x461135(0x150)](_0xbcd0db['framework'],_0x537dba);!helper['isBrowserstackInfra']()&&await _0xbcd0db[_0x461135(0x166)]();await helper[_0x461135(0x165)](_0xbcd0db[_0x461135(0x16f)]);const _0x4cab81=helper[_0x461135(0x120)](_0xbcd0db[_0x461135(0x16f)]);!helper[_0x461135(0x17f)](_0xbcd0db[_0x461135(0x16f)]['accessibilityOptions'])&&(process['env'][_0x461135(0x164)]=JSON['stringify'](_0xbcd0db[_0x461135(0x16f)][_0x461135(0x112)]));if(!BrowserstackCLI['getInstance']()[_0x461135(0x16e)]()){const _0x2e2f83=await TestHubHandler['launchBuild'](constants[_0x461135(0x12d)]['CUCUMBER'],_0xbcd0db);}let _0x4aaff5=[];if(!helper[_0x461135(0x124)]()){const _0x2c0615={};_0x2c0615[_0x461135(0x194)]=[],_0x4aaff5=helper[_0x461135(0x136)](Object['assign']({},_0xbcd0db[_0x461135(0x16f)],_0x2c0615),_0x4cab81,constants[_0x461135(0x12d)]['CUCUMBER']);}else _0x4aaff5=helper[_0x461135(0x136)](_0xbcd0db[_0x461135(0x16f)],_0x4cab81,constants[_0x461135(0x12d)][_0x461135(0x111)]);if(!_0xbcd0db[_0x461135(0x16f)])return;const _0x76d8b1=_0xbcd0db['config']['parallelsPerPlatform']||helper[_0x461135(0x11e)](_0x537dba,_0x1d252a,_0xbcd0db[_0x461135(0x16f)],constants['FRAMEWORKS'][_0x461135(0x111)])||0x1,_0x214494={'server':helper[_0x461135(0x12c)](_0xbcd0db[_0x461135(0x16f)]),'proxySettings':_0xbcd0db['config'][_0x461135(0x14f)],'maxWorkers':_0x76d8b1,'browserStackLogLevel':_0xbcd0db[_0x461135(0x16f)][_0x461135(0x118)],'skipSessionName':_0xbcd0db['config'][_0x461135(0x141)]['skipSessionName'],'skipSessionStatus':_0xbcd0db[_0x461135(0x16f)][_0x461135(0x141)]['skipSessionStatus'],'turboScaleUrl':_0xbcd0db[_0x461135(0x16f)][_0x461135(0x151)]},_0x3a8548=process['argv'],[_0x5bd0f9,_0x8c2ad8]=helper['parseFormatters'](_0x3a8548),_0x177e52=path[_0x461135(0x153)](process[_0x461135(0x167)](),_0x176df5[_0x461135(0x146)]);if(_0x176df5[_0x461135(0x17b)](_0x8c2ad8[_0x461135(0x18b)],0x0)){helper[_0x461135(0x15c)](_0x177e52);for(let _0x4464f6=_0x176df5[_0x461135(0x110)](_0x5bd0f9[_0x461135(0x18b)],0x1);_0x176df5['OyLVd'](_0x4464f6,0x0);_0x4464f6--){_0x3a8548[_0x461135(0x160)](_0x5bd0f9[_0x4464f6],0x2);}}_0x176df5[_0x461135(0x12a)](_0xbcd0db[_0x461135(0x16f)][_0x461135(0x183)],null)?process[_0x461135(0x17c)]['BROWSERSTACK_TEST_OBSERVABILITY_YML']=_0xbcd0db[_0x461135(0x16f)][_0x461135(0x183)]:process[_0x461135(0x17c)][_0x461135(0x152)]=_0x176df5['SSXxO'];PerformanceTester[_0x461135(0x161)](PerformanceEvents[_0x461135(0x158)]);let _0x28ce81;_0x176df5['sYHlf'](parallelCucumberRun,_0x4aaff5,_0x214494,_0xbcd0db[_0x461135(0x16f)],_0x3a8548,_0x8c2ad8)[_0x461135(0x15e)](async _0xf86bcf=>{const _0x24eba4=_0x461135;PerformanceTester['start'](PerformanceEvents[_0x24eba4(0x11c)]),_0x28ce81=_0xf86bcf;const _0x23a8b9=_0x176df5[_0x24eba4(0x119)](printCucumberStats,_0xf86bcf);process['exitCode']=_0x23a8b9,_0x176df5[_0x24eba4(0x181)](_0x8c2ad8[_0x24eba4(0x18b)],0x0)&&(logger[_0x24eba4(0x157)](_0x176df5[_0x24eba4(0x11b)]),helper[_0x24eba4(0x13b)](_0x177e52,_0x8c2ad8),logger[_0x24eba4(0x157)](_0x176df5[_0x24eba4(0x149)]),helper[_0x24eba4(0x16c)](_0x177e52));})['finally'](async()=>{const _0x454da2=_0x461135;PerformanceTester[_0x454da2(0x188)](PerformanceEvents[_0x454da2(0x11c)]),_0xbcd0db['errorMessage']=helper[_0x454da2(0x128)](_0x28ce81,_0x176df5[_0x454da2(0x123)]),testOpsHelper[_0x454da2(0x13f)]();try{await TestHubHandler[_0x454da2(0x177)](),await BrowserstackCLI[_0x454da2(0x18d)]()[_0x454da2(0x177)]();}catch(_0x359769){logger[_0x454da2(0x157)](_0x454da2(0x159)+util[_0x454da2(0x135)](_0x359769));}try{const {browserstackFolderPath:_0x1e28b7,tcgConfigPath:_0x2fd3c5}=helper[_0x454da2(0x16d)]();fs[_0x454da2(0x145)](_0x2fd3c5),fs['rmdirSync'](_0x1e28b7);}catch(_0x7c75c1){logger[_0x454da2(0x157)](_0x176df5[_0x454da2(0x162)],_0x7c75c1);}await utilities[_0x454da2(0x193)](_0xbcd0db);});}module[a5_0xbd6a01(0x190)]=run;