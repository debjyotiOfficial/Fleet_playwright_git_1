const a78_0x87f43a=a78_0x10d2;function a78_0x10d2(_0x4ac1be,_0x4d841d){const _0x2508bc=a78_0x2508();return a78_0x10d2=function(_0x10d254,_0x284440){_0x10d254=_0x10d254-0x18b;let _0x5945cc=_0x2508bc[_0x10d254];return _0x5945cc;},a78_0x10d2(_0x4ac1be,_0x4d841d);}(function(_0x411e47,_0x47aa02){const _0x2135f3=a78_0x10d2,_0x93f686=_0x411e47();while(!![]){try{const _0xcb567a=parseInt(_0x2135f3(0x18b))/0x1+parseInt(_0x2135f3(0x1a6))/0x2+parseInt(_0x2135f3(0x1a3))/0x3*(-parseInt(_0x2135f3(0x1ac))/0x4)+-parseInt(_0x2135f3(0x1c0))/0x5*(parseInt(_0x2135f3(0x1d5))/0x6)+-parseInt(_0x2135f3(0x1c2))/0x7+-parseInt(_0x2135f3(0x1aa))/0x8+parseInt(_0x2135f3(0x1ce))/0x9;if(_0xcb567a===_0x47aa02)break;else _0x93f686['push'](_0x93f686['shift']());}catch(_0x51f1ce){_0x93f686['push'](_0x93f686['shift']());}}}(a78_0x2508,0xc86b2));const util=require(a78_0x87f43a(0x1bc)),BaseModule=require('./baseModule'),{createClassLogger}=require(a78_0x87f43a(0x1a4)),AutomationFramework=require(a78_0x87f43a(0x1b8)),AutomationFrameworkState=require(a78_0x87f43a(0x199)),HookState=require(a78_0x87f43a(0x1c3)),TestFramework=require(a78_0x87f43a(0x19a)),TestFrameworkState=require(a78_0x87f43a(0x1bb)),PlaywrightDriverModule=require(a78_0x87f43a(0x1ea)),TestFrameworkConstants=require(a78_0x87f43a(0x191)),GrpcClient=require(a78_0x87f43a(0x1e1)),CLIUtils=require(a78_0x87f43a(0x1ab)),TestInfo=require(a78_0x87f43a(0x1b2)),testHubConstants=require(a78_0x87f43a(0x190)),BrowserstackCLI=require(a78_0x87f43a(0x1c6)),{getPlaywrightProvider}=require('../../../helpers/helper.js'),{getTestRunIdentifier}=require(a78_0x87f43a(0x19e));function a78_0x2508(){const _0xbd9a3=['../framework/automationFramework.js','stringify','instance','../state/testFrameworkState.js','util','logger','error','KEY_TEST_FRAMEWORK_NAME','70ZksgdB','IERGW','4530617sWYORJ','../state/hookState.js','parallelIndex','getAllData','../browserstackCLI.js','onPageCreate\x20CBTSession\x20payload:\x20','get','values','page','getTestDetails','testFrameworkVersion','getRef','37587483eBsFIV','registerObserver','XDeyT','testSessionEvent','testhubConfig','getInstance','testFrameworkState','257592MLRepn','KEY_CAPABILITIES','kukTo','executionContext','startedAt','debug','from','bind','sendTestFrameworkEvent\x20complete\x20for\x20testId:\x20','POST','result','FzrOO','../grpcClient.js','KEY_TEST_STARTED_AT','TEST','KEY_HUB_URL','sendTestFrameworkEvent\x20testId:\x20','getTestIdentifierFromTestInfo','onPageCreate\x20Sending\x20CBT\x20for\x20testId:\x20','BROWSERSTACK_TESTHUB_UUID','testFrameworkName','./playwrightDriverModule.js','getState','capabilities','testHookState','getJwt','getId','test','toString','Error\x20in\x20sending\x20CBTSession:\x20','157910WuYnee','2|5|4|0|3|7|1|6','onPageCreate\x20CBTSession\x20complete\x20for\x20testId:\x20','ENV_VAR','MODULE_NAME','../../../helpers/testhub/constants','../framework/constants/testFrameworkConstants.js','base64','TestHubModule','platformIndex','getCurrentHookState','forEach','KEY_TEST_DEFERRED','test_deferred','../state/automationFrameworkState.js','../framework/testFramework.js','exports','\x20hookState:\x20','automationSession','../../playwright/reporter/pwUtils.js','TmLQG','split','getCurrentTestState','matchHookRegex','590412KVQCSN','../../../helpers/classLogger.js','sendTestFrameworkEvent','475750TlsHww','format','onPageCreate','env','9002808HMJtLZ','../cliUtils.js','28CakclF','getContext','frAQm','getProcessId','KEY_TEST_ENDED_AT','getBuildHashedId','../TestInfo.js','testInfo','rJlah','KEY_SESSION_ID','BROWSERSTACK_TESTHUB_JWT','KEY_TEST_FRAMEWORK_VERSION'];a78_0x2508=function(){return _0xbd9a3;};return a78_0x2508();}class TestHubModule extends BaseModule{[a78_0x87f43a(0x1bd)]=createClassLogger(a78_0x87f43a(0x193));constructor(_0x512409){const _0x549a81=a78_0x87f43a,_0x5a2077={};_0x5a2077[_0x549a81(0x1c1)]=_0x549a81(0x18c),_0x5a2077['frAQm']=_0x549a81(0x193);const _0x37dcf0=_0x5a2077,_0x118640=_0x37dcf0[_0x549a81(0x1c1)]['split']('|');let _0x1ba462=0x0;while(!![]){switch(_0x118640[_0x1ba462++]){case'0':AutomationFramework[_0x549a81(0x1cf)](AutomationFrameworkState['CREATE'],HookState[_0x549a81(0x1de)],this['onPageCreate'][_0x549a81(0x1dc)](this));continue;case'1':process[_0x549a81(0x1a9)][testHubConstants[_0x549a81(0x18e)][_0x549a81(0x1e8)]]=this[_0x549a81(0x1d2)][_0x549a81(0x1b1)]();continue;case'2':super();continue;case'3':Object['values'](TestFrameworkState)['forEach'](_0x17d685=>{const _0x9baa4c=_0x549a81;Object[_0x9baa4c(0x1c9)](HookState)[_0x9baa4c(0x196)](_0x5d0adc=>{const _0xd526e1=_0x9baa4c;TestFramework[_0xd526e1(0x1cf)](_0x17d685,_0x5d0adc,this['onAllTestEvents'][_0xd526e1(0x1dc)](this));});});continue;case'4':this[_0x549a81(0x1d2)]=_0x512409;continue;case'5':this['name']=_0x37dcf0[_0x549a81(0x1ae)];continue;case'6':BrowserstackCLI['O11yHashedID']=this[_0x549a81(0x1d2)][_0x549a81(0x1b1)]();continue;case'7':process[_0x549a81(0x1a9)][testHubConstants[_0x549a81(0x18e)][_0x549a81(0x1b6)]]=this[_0x549a81(0x1d2)][_0x549a81(0x1ee)]();continue;}break;}}['getModuleName'](){const _0x93879c=a78_0x87f43a;return TestHubModule[_0x93879c(0x18f)];}['onAllTestEvents'](_0x641b52){const _0x2e454e=a78_0x87f43a,_0x2ac931={};_0x2ac931[_0x2e454e(0x1e0)]=function(_0x5b0766,_0x1723f2){return _0x5b0766===_0x1723f2;};const _0x3c1454=_0x2ac931,_0x1ea9fd=_0x641b52['instance'],_0x5c7da8=_0x1ea9fd[_0x2e454e(0x1a1)]();(_0x3c1454[_0x2e454e(0x1e0)](_0x5c7da8,TestFrameworkState['TEST'])||CLIUtils[_0x2e454e(0x1a2)](_0x5c7da8[_0x2e454e(0x1f1)]()[_0x2e454e(0x1a0)]('.')[0x1]))&&this[_0x2e454e(0x1a5)](_0x641b52);}async[a78_0x87f43a(0x1a5)](_0x1746d0){const _0x16f3dc=a78_0x87f43a,_0x38c0f3={'XDeyT':function(_0x19ab78,_0x29bcd2,_0x5066c1){return _0x19ab78(_0x29bcd2,_0x5066c1);},'kukTo':_0x16f3dc(0x192)};try{const _0x316f08=_0x1746d0[_0x16f3dc(0x1f0)]['id'],_0x2abc53=_0x38c0f3[_0x16f3dc(0x1d0)](getTestRunIdentifier,_0x1746d0[_0x16f3dc(0x1f0)],_0x1746d0[_0x16f3dc(0x1df)]['retry']),_0xa522c6=_0x1746d0[_0x16f3dc(0x1ba)],_0x54dd76=_0xa522c6[_0x16f3dc(0x1ad)](),_0x12cc28=_0xa522c6[_0x16f3dc(0x1c5)]()[_0x16f3dc(0x1c8)](_0x2abc53);this[_0x16f3dc(0x1bd)][_0x16f3dc(0x1da)](_0x16f3dc(0x1e5)+_0x316f08);const {[TestFrameworkConstants[_0x16f3dc(0x1bf)]]:_0x5fdd07='',[TestFrameworkConstants['KEY_TEST_FRAMEWORK_VERSION']]:_0x1b0987='',[TestFrameworkConstants[_0x16f3dc(0x1e2)]]:_0x454c36='',[TestFrameworkConstants[_0x16f3dc(0x1b0)]]:_0x3f4536=''}=_0x12cc28,_0x2b5a4e=_0xa522c6[_0x16f3dc(0x1a1)]()[_0x16f3dc(0x1f1)]()[_0x16f3dc(0x1a0)]('.')[0x1],_0x448863=_0xa522c6[_0x16f3dc(0x195)]()[_0x16f3dc(0x1f1)]()[_0x16f3dc(0x1a0)]('.')[0x1],_0x3b0458=global?.['__workerDetails']?.['workerInfo']?.[_0x16f3dc(0x1c4)];;const _0x55d5b5=_0xa522c6[_0x16f3dc(0x1cd)](),_0x4f5193=Buffer['from'](JSON['stringify'](_0x12cc28))[_0x16f3dc(0x1f1)](_0x38c0f3[_0x16f3dc(0x1d7)]),_0xe61e1d={'hash':_0x54dd76['getId'](),'threadId':_0x54dd76['getThreadId']()[_0x16f3dc(0x1f1)](),'processId':_0x54dd76[_0x16f3dc(0x1af)]()[_0x16f3dc(0x1f1)]()},_0x3356c7={};_0x3356c7[_0x16f3dc(0x194)]=_0x3b0458,_0x3356c7['testFrameworkName']=_0x5fdd07,_0x3356c7[_0x16f3dc(0x1cc)]=_0x1b0987,_0x3356c7[_0x16f3dc(0x1d4)]=_0x2b5a4e,_0x3356c7['hookState']=_0x448863,_0x3356c7[_0x16f3dc(0x1d9)]=_0x454c36,_0x3356c7['endedAt']=_0x3f4536,_0x3356c7['uuid']=_0x55d5b5,_0x3356c7['eventJson']=_0x4f5193,_0x3356c7[_0x16f3dc(0x1d8)]=_0xe61e1d;const _0x6a63f5=_0x3356c7,_0x565fba=await GrpcClient[_0x16f3dc(0x1d3)]()['testFrameworkEvent'](_0x6a63f5);this[_0x16f3dc(0x1bd)][_0x16f3dc(0x1da)](_0x16f3dc(0x1dd)+_0x316f08+'\x20testState:\x20'+_0x2b5a4e+_0x16f3dc(0x19c)+_0x448863);}catch(_0x490832){this[_0x16f3dc(0x1bd)][_0x16f3dc(0x1be)]('Error\x20in\x20sendTestFrameworkEvent:\x20'+util['format'](_0x490832));}}async[a78_0x87f43a(0x1a8)](_0x479832){const _0x2e1ccd=a78_0x87f43a,_0x47609c={'rJlah':function(_0x58d3ab,_0x56b7cd){return _0x58d3ab(_0x56b7cd);},'TmLQG':_0x2e1ccd(0x192)};try{if(_0x479832[_0x2e1ccd(0x1ca)]){const _0x2423fa=_0x479832[_0x2e1ccd(0x1b3)]['testId'];this[_0x2e1ccd(0x1bd)][_0x2e1ccd(0x1da)](_0x2e1ccd(0x1e7)+_0x2423fa);const _0x11e68f=TestInfo[_0x2e1ccd(0x1e6)](_0x479832['testInfo'],_0x479832[_0x2e1ccd(0x1b3)]['retry']),_0x4241bc=TestInfo['getTestUUID'](_0x11e68f),_0x1e08e5=TestInfo[_0x2e1ccd(0x1cb)](_0x11e68f),_0x59d26c=_0x479832['instance'],_0xff1848=AutomationFramework[_0x2e1ccd(0x1eb)](_0x59d26c,PlaywrightDriverModule['KEY_PLATFORM_INDEX']),_0x459feb=_0x1e08e5[TestFrameworkConstants[_0x2e1ccd(0x1bf)]],_0x4b15cf=_0x1e08e5[TestFrameworkConstants[_0x2e1ccd(0x1b7)]],_0x478a2a=TestFrameworkState[_0x2e1ccd(0x1e3)][_0x2e1ccd(0x1f1)]()[_0x2e1ccd(0x1a0)]('.')[0x1],_0x17c000=HookState[_0x2e1ccd(0x1de)][_0x2e1ccd(0x1f1)]()['split']('.')[0x1],_0xb86b39=_0x59d26c['getContext'](),_0x1c427b=AutomationFramework['getState'](_0x59d26c,PlaywrightDriverModule[_0x2e1ccd(0x1e4)],''),_0x61d84f={'provider':_0x47609c[_0x2e1ccd(0x1b4)](getPlaywrightProvider,_0x1c427b),'frameworkName':_0x59d26c['frameworkName'],'frameworkVersion':_0x59d26c['frameworkVersion'],'frameworkSessionId':AutomationFramework[_0x2e1ccd(0x1eb)](_0x59d26c,PlaywrightDriverModule[_0x2e1ccd(0x1b5)],''),'ref':_0x59d26c[_0x2e1ccd(0x1cd)](),'hubUrl':_0x1c427b};let _0x46815b=AutomationFramework[_0x2e1ccd(0x1eb)](_0x59d26c,PlaywrightDriverModule[_0x2e1ccd(0x1d6)],{});_0x46815b=Buffer[_0x2e1ccd(0x1db)](JSON[_0x2e1ccd(0x1b9)](_0x46815b))[_0x2e1ccd(0x1f1)](_0x47609c[_0x2e1ccd(0x19f)]);const _0x3577dd={'hash':_0xb86b39[_0x2e1ccd(0x1ef)](),'threadId':_0xb86b39['getThreadId']()[_0x2e1ccd(0x1f1)](),'processId':_0xb86b39[_0x2e1ccd(0x1af)]()['toString']()},_0x10cab6={};_0x10cab6[_0x2e1ccd(0x194)]=_0xff1848,_0x10cab6[_0x2e1ccd(0x1e9)]=_0x459feb,_0x10cab6[_0x2e1ccd(0x1cc)]=_0x4b15cf,_0x10cab6['testFrameworkState']=_0x478a2a,_0x10cab6[_0x2e1ccd(0x1ed)]=_0x17c000,_0x10cab6['testUuid']=_0x4241bc,_0x10cab6[_0x2e1ccd(0x19d)]=_0x61d84f,_0x10cab6[_0x2e1ccd(0x1ec)]=_0x46815b,_0x10cab6['executionContext']=_0x3577dd;const _0xd4e296=_0x10cab6;this[_0x2e1ccd(0x1bd)][_0x2e1ccd(0x1da)](_0x2e1ccd(0x1c7)+util[_0x2e1ccd(0x1a7)](_0xd4e296));const _0xcd518b=await GrpcClient[_0x2e1ccd(0x1d3)]()[_0x2e1ccd(0x1d1)](_0xd4e296);this[_0x2e1ccd(0x1bd)]['debug'](_0x2e1ccd(0x18d)+_0x2423fa);}}catch(_0x516aa2){this['logger'][_0x2e1ccd(0x1be)](_0x2e1ccd(0x1f2)+util['format'](_0x516aa2));}}}TestHubModule['MODULE_NAME']=a78_0x87f43a(0x193),TestHubModule[a78_0x87f43a(0x197)]=a78_0x87f43a(0x198),module[a78_0x87f43a(0x19b)]=TestHubModule;